// =============================================================================
// WS2812B test - light up 16 RGB LEDs
// =============================================================================

#include <util/delay.h>
#include "drivers/comm/ws2812b.h"


struct cRGB led[16];

void application__init(void) {
}


// main
// -----------------------------------------------------------------------------
int main(void) __attribute__ ((naked));
int main(void) {
    application__init();
    _delay_ms(500);

#if !defined(__AVR_ARCH__)
#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Wmissing-noreturn"
#endif
    for(;;) {
        led[0].r=0x01; led[0].g=0x00; led[0].b=0x00;
        led[1].r=0x00; led[1].g=0x01; led[1].b=0x00;
        led[2].r=0x00; led[2].g=0x00; led[2].b=0x01;
        led[3].r=0x04; led[3].g=0x04; led[3].b=0x04;
        led[0x04].r=0x02; led[0x04].g=0x00; led[0x04].b=0x00;
        led[0x05].r=0x00; led[0x05].g=0x02; led[0x05].b=0x00;
        led[0x06].r=0x00; led[0x06].g=0x00; led[0x06].b=0x02;
        led[0x07].r=0x03; led[0x07].g=0x03; led[0x07].b=0x03;

        led[0x08].r=0x04; led[0x08].g=0x00; led[0x08].b=0x00;
        led[0x09].r=0x00; led[0x09].g=0x04; led[0x09].b=0x00;
        led[0x0a].r=0x00; led[0x0a].g=0x00; led[0x0a].b=0x04;
        led[0x0b].r=0x02; led[0x0b].g=0x02; led[0x0b].b=0x02;
        led[0x0c].r=0x06; led[0x0c].g=0x00; led[0x0c].b=0x00;
        led[0x0d].r=0x00; led[0x0d].g=0x06; led[0x0d].b=0x00;
        led[0x0e].r=0x00; led[0x0e].g=0x00; led[0x0e].b=0x06;
        led[0x0f].r=0x01; led[0x0f].g=0x01; led[0x0f].b=0x01;

        ws2812_setleds(led, 16);
        _delay_ms(500);                         

        led[0].r=0x01; led[0].g=0x01; led[0].b=0x00;
        led[1].r=0x00; led[1].g=0x01; led[1].b=0x01;
        led[2].r=0x01; led[2].g=0x00; led[2].b=0x01;
        led[3].r=0x01; led[3].g=0x01; led[3].b=0x01;
        led[0x04].r=0x02; led[0x04].g=0x02; led[0x04].b=0x00;
        led[0x05].r=0x00; led[0x05].g=0x02; led[0x05].b=0x02;
        led[0x06].r=0x02; led[0x06].g=0x00; led[0x06].b=0x02;
        led[0x07].r=0x02; led[0x07].g=0x02; led[0x07].b=0x02;

        led[0x08].r=0x04; led[0x08].g=0x04; led[0x08].b=0x00;
        led[0x09].r=0x00; led[0x09].g=0x04; led[0x09].b=0x04;
        led[0x0a].r=0x04; led[0x0a].g=0x00; led[0x0a].b=0x04;
        led[0x0b].r=0x04; led[0x0b].g=0x04; led[0x0b].b=0x04;
        led[0x0c].r=0x02; led[0x0c].g=0x00; led[0x0c].b=0x00;
        led[0x0d].r=0x00; led[0x0d].g=0x02; led[0x0d].b=0x00;
        led[0x0e].r=0x00; led[0x0e].g=0x00; led[0x0e].b=0x02;
        led[0x0f].r=0x02; led[0x0f].g=0x02; led[0x0f].b=0x02;

        ws2812_setleds(led, 16);
        _delay_ms(500);
    }

#if !defined(__AVR_ARCH__)
#pragma clang diagnostic pop
#endif

#if !defined(__AVR_ARCH__)
#pragma clang diagnostic push
#pragma ide diagnostic ignored "OCDFAInspection"
#endif
    return 0;
#if !defined(__AVR_ARCH__)
#pragma clang diagnostic pop
#endif
}
